var S=Object.defineProperty;var I=(e,t,n)=>t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var f=(e,t,n)=>(I(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function y(e){const t=new DataTransfer;let n=0;const o=new Map;for(const s of Array.from(e))if(T(s))t.items.add(s);else{n+=1;const i=s.name.lastIndexOf("."),r=i<=0?"":s.name.slice(i+1),a=o.get(r);o.set(r,a?a+1:1)}return{discardedCount:n,discardedCountsPerType:o,files:t.files}}function T(e){const t=/^image\/(?:jpeg|png|gif|webp|avif|svg\+xml|targa)/i,n=/\.(?:jpe?g|png|gif|webp|avif|svg\+xml|tga)$/i;return t.test(e.type)||n.test(e.name)}function w({discardedCount:e,discardedCountsPerType:t,files:n}){const o=Array.from(t.entries()).sort(P).reduce((i,[r,a])=>`${i}
- *.${r} 파일 ${a}개`,""),s=n.length+e;window.alert(`파일 ${s}개 중 ${e}개가 선택에서 제외됩니다.
${o}`)}function P(e,t){const n=t[1]-e[1];return n===0?e[0]<t[0]?-1:e[0]>t[0]?1:0:n}function m(e,t){const n=e.querySelector(t);if(!n)throw new Error(`"${t}" is not found.`);return n}function E(e){const t=m(document,"#file-list ol");if(!e||e.length===0)for(const n of t.children)n.remove();else{const n=[];for(const{name:o}of e){const s=document.createElement("li");s.textContent=o,n.push(s)}t.replaceChildren(...n)}}function $(e){var o,s,i;if(e.preventDefault(),document.body.classList.contains("packing"))return;if(!((s=(o=e.dataTransfer)==null?void 0:o.files)!=null&&s.length))return;const t=y(e.dataTransfer.files);t.discardedCount&&w(t);const n=(i=document.forms.namedItem("app"))==null?void 0:i.elements.namedItem("files");n instanceof HTMLInputElement&&n.type==="file"&&(n.files=t.files),E(t.files)}function C(){const e=y(this.files??new FileList);e.discardedCount&&w(e),this.files=e.files,E(e.files)}const x="modulepreload",B=function(e){return"/img-seq-pack/"+e},h={},N=function(t,n,o){if(!n||n.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=B(i),i in h)return;h[i]=!0;const r=i.endsWith(".css"),a=r?'[rel="stylesheet"]':"";if(!!o)for(let u=s.length-1;u>=0;u--){const d=s[u];if(d.href===i&&(!r||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${a}`))return;const l=document.createElement("link");if(l.rel=r?"stylesheet":x,r||(l.as="script",l.crossOrigin=""),l.href=i,document.head.appendChild(l),r)return new Promise((u,d)=>{l.addEventListener("load",u),l.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>t())},b={"image-enlarge":!0,"keep-extension":!1,"page-description":!1,"page-number":!0,"page-sort":!0,"page-sort-natural":!0,"page-sort-split":!0,replace:!1,"replace-regex":!1},L={"page-height":540,"page-number-start":1,"page-width":960,"quality-jpeg":90},v={"background-color":"#5e5e5e","replace-find":"","replace-replace":"",title:"img-seq-pack"},O=new Set(Object.keys(b)),k=new Set(Object.keys(L)),M=new Set(Object.keys(v)),D=new Set([...O,...k,...M]);function F(e){return O.has(e)}function H(e){return k.has(e)}function K(e){return M.has(e)}function R(e){return D.has(e)}function _(e){const t=new Set;for(let i=0;i<e.elements.length;i+=1){const r=e.elements[i];if(r instanceof HTMLInputElement){const a=r.name;R(a)&&t.add(a)}}const n={...b},o={...L},s={...v};for(const i of t){const r=e.elements.namedItem(i);if(F(i))n[i]=r.checked;else if(H(i)){const a=r.valueAsNumber;Math.abs(a)<=Number.MAX_SAFE_INTEGER&&(o[i]=a)}else K(i)&&(s[i]=r.value)}return{...n,...o,...s}}function A(e,t){const n=e.elements.namedItem(t);if(n instanceof HTMLInputElement)return n;throw n instanceof RadioNodeList?new Error(`"${t}" in "#${e.id}" is a RadioNodeList.`):new Error(`"${t}" as an HTMLInputelement is not found in "#${e.id}".`)}class p{constructor(t,n){f(this,"progressElement");f(this,"descriptionElement");f(this,"aborted");f(this,"begin");this.progressElement=m(document,t),this.descriptionElement=m(document,n),this.aborted=!1,this.begin=Date.now()}async update(t){if(this.aborted)return!1;const n=Math.floor(t*100),o=Math.floor((Date.now()-this.begin)/1e3);return this.progressElement.value=t,this.descriptionElement.textContent=`${n}% (${o}초)`,await Promise.resolve(),!0}async reset(t){return this.aborted?!1:(this.begin=Date.now(),await this.update(t))}async complete(){if(this.aborted)return!1;const t=Math.ceil((Date.now()-this.begin)/100)/10;return this.progressElement.value=1,this.descriptionElement.textContent=`완료 (${t}초)`,await Promise.resolve(),!0}async cancel(){return this.aborted=!0,this.descriptionElement.textContent="취소됨: "+(this.descriptionElement.textContent??""),await Promise.resolve(),!1}static async withUpdate(t,n,o){const s=new p(t,n);return await s.update(o),s}}const j=new Set(["checkbox","file","number","radio","text"]);function g(e,t){for(let o=0;o<e.elements.length;o+=1){const s=e.elements.item(o);s instanceof HTMLInputElement&&j.has(s.type)&&(s.disabled=!t)}const n=e.elements.namedItem("button-pack");n&&n instanceof HTMLButtonElement&&(n.textContent=t?"변환하기":"취소"),t?document.body.classList.remove("packing"):document.body.classList.add("packing")}let c=null;async function q(){var t;const e=this.form;if(!e)throw new Error("This pack button doesn't belong to the root form element.");if(c)c.cancel(),c=null;else{const n=A(e,"files");if(!((t=n==null?void 0:n.files)!=null&&t.length)){e.reportValidity();return}g(e,!1);const o=_(e);c=await p.withUpdate("#pack-progress","#pack-description",0);const s=(await N(()=>import("./buildDocument-85a2b1c8.js"),[])).default;await s(n.files,o,c)&&await c.complete()}c=null,g(e,!0)}function U(){const e=m(document,"#app"),t=e.elements.namedItem("button-pack");if(!t||!(t instanceof HTMLButtonElement))throw new Error('"button-pack" as HTMLButtonElement is not found.');t.addEventListener("click",q);const n=e.elements.namedItem("files");if(!n||!(n instanceof HTMLInputElement))throw new Error('"files" as HTMLInputElement is not found.');n.addEventListener("change",C),document.body.addEventListener("dragover",o=>o.preventDefault()),document.body.addEventListener("drop",$)}U();export{N as _};
